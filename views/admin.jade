doctype html(lang='en')
head
    meta(charset='utf-8')
    |     
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    |     
    meta(name='viewport', content='width=device-width, initial-scale=1')
    |     
    title ADMIN
    // Bootstrap
    link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')
    // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
    // WARNING: Respond.js doesn't work if you view the page via file://
    //if lt IE 9
      script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
      |       
      script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')
    |     
    style.
      html{
      min-width:768px;
      }
      @font-face {
      font-family:br;
      src:url('/bootstrap/fonts/bebasneue_regular.ttf');
      }
      @font-face {
      font-family:attentica;
      src:url('/bootstrap/fonts/Attentica.ttf');
      }
      @font-face {
      font-family:roboto-thin;
      src:url('/bootstrap/fonts/Roboto-Thin.ttf');
      }
      h1 {
      font-family:attentica;
      font-size:5vw;
      color:#333;
      }
      h2 {
      line-height:8vh;
      color:black;
      font-family:roboto-thin;
      font-size:2vw;
      margin-top:1vh;
      margin-bottom:1vh;
      margin-right:1vw;
      margin-left:1vw;
      font-weight:bold;
      }
      h4 {
      color:#ddd;
      font-family:roboto-thin;
      text-transform:uppercase;
      font-size:3vw;
      }
      .container {
      margin:0px;
      padding:0px;
      width:100%;
      }
      .btn-default {
      background-color:white;
      }
      .btn:hover {
      background-color:white;
      opacity:0.5;
      }
      .btn-default:focus {
      background-color:white;
      }
      .btn-default:focus h2 {
      color:black;
      }
      .btn:hover h2 {
      color:black;
      }
      #menu {
      text-align:center;
      padding-top:5vh;
      padding-bottom:5vh;
      background-color:#eee;
      }
      #header {
      background-color:#eee;
      text-align:center;
      }
      .title {
      padding-left:2vw;
      background-color:#0b4556;
      border-bottom:1px solid #53a7bf;
      cursor:pointer;
      }
      .closedialog{
      cursor:pointer;
      }
      .closedialog:hover{
      background-color:#0b4556;
      }
      #addextraalbum{
      cursor:pointer;
      }
      #addextraalbum:hover{
      background-color:#0b4556;
      }
      #addextraalbum:hover h2{
      color:white;
      }
      .title:hover{
      background-color:#216d83;
      }
      a:hover {
      outline:none;
      text-decoration:none;
      }
      .addsmth{
      margin-bottom:1vh;
      }
      .stats {
      background-color:#eee;
      padding-left:3vw;
      padding-right:3vw;
      padding-top:3vh;
      padding-bottom:3vh;
      }
      h5 {
      font-size:1vw;
      font-family:arial;
      letter-spacing:0.3vw;
      text-transform:uppercase;
      color:black;
      }
      input {
      margin:1vh;
      border:1px solid #ddd;
      line-height:8vh;
      color:black;
      font-family:roboto-thin;
      font-size:2vw;
      font-weight:bold;
      }
      button {
      margin:1vh;
      }
      #addpost:hover{
      background-color:#ddd;
      }
      #removepost:hover{
      background-color:#ddd;
      }
      p{ 
      text-indent:1vw;
      }
      img{
      height:3vw;
      margin:2vh;
      }
      .col-xs-1 {
      padding-left:0px;
      }
      .col-xs-3 {
      padding-left:0px;
      }
      .hiddeninputs {
      display:none;
      margin:0px;
      padding:1vw;
      background-color:#eee;
      }
      .addsmth {
      cursor:pointer;
      }
      .addsmth:hover{
      background-color:#eee;
      }
      .hiddenoptions{
      margin:0px;
      padding:0px;
      display:none;
      background-color:#f7f7f7;
      }
      .nb{
      margin:0px;
      padding:0px;
      }
      .simplyhidden{
      display:none;
      }
      textarea{
      color:black;
      font-family:roboto-thin;
      font-size:2vw;
      font-weight:bold;
      }
      .form-control{
      font-size:2vw;
      }
      input{
      border-radius:4px;
      }
      .updatebutton:hover{
       background-color:#53a7bf;
      }
      .post:hover {
      background-color:#0b4556;
      }
      .post:hover h2 {
      color:white;
      }
      #removeposts:hover{
      background-color:#0b4556;
      }
      #removeposts:hover h2{
      color:white;
      }
  body
    // jQuery (necessary for Bootstrap's JavaScript plugins)
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js')
    // Include all compiled plugins (below), or include individual files as needed
    script(src='/bootstrap/js/bootstrap.min.js')
    .container
      //
        #countriesblock.row.section
          .col-xs-6
            .row.title
              .col-xs-1
                img(src='/bootstrap/images/circle_bird_down_white.png')
              .col-xs-11
                h4 &Scy;&Tcy;&Rcy;&Acy;&Ncy;&Ycy;  
      .row
        .col-xs-3(style='background-color:#0b4556;height:100vh;')
          .row(style='background-color:#333;padding:0px;text-align:center;')
            .col-xs-12(style='padding-right:0px;')
              h1(style='color:#eee;') Редактор
          #routesblock.row.section
            .col-xs-12
              .row.title
                .col-xs-12
                  h4 Маршруты
          #booksblock.row.section
             .col-xs-12
               .row.title
                 .col-xs-12
                   h4 Книги 
          #blogblock.row.section
            .col-xs-12
              .row.title
                .col-xs-12
                  h4 &Bcy;&Lcy;&Ocy;&Gcy;   
          #gallblock.row.section
            .col-xs-12
              .row.title
                .col-xs-12
                  h4 &Gcy;&Acy;&Lcy;&IEcy;&Rcy;&IEcy;&YAcy;    
          #contactsblock.row.section
            .col-xs-12
              .row.title
                .col-xs-12
                  h4 Контакты   
          #aboutblock.row.section
            .col-xs-12
              .row.title
                .col-xs-12
                  h4 О проекте                               
        .col-xs-9(style='padding:0px;')           
          #routesblockoptions.row.hiddenoptions
            .col-xs-6.nb         
              #addroute.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_cross.png')
                .col-xs-10(style='padding-left:0px;')
                  h2 Добавить маршрут          
              #updateroute.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_text_edit.png')      
                .col-xs-10(style='padding-left:0px;')
                  h2  Редактировать маршрут
              #removeallroutes.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_minus.png')      
                .col-xs-10(style='padding-left:0px;')
                  h2  Удалить все маршруты      
              script.
                $('#addroute').click(function(){$('#addrouteblock').slideToggle();});   
                $('#removeallroutes').click(function(){$('#droproutesdb').slideToggle();}); 
                $('#updateroute').click(function(){updateroutelist();});
          #droproutesdb.row.hiddeninputs(style='display:none;background-color:#ca2c28;padding-top:3vh;')
            form(action='/drop/routes',method='post',role='form')  
              .row
                .col-xs-1(style='text-align:right;')
                  img(src='/bootstrap/images/circle_excl_white.png')
                .col-xs-10
                  h2(style='color:white;') Удалить все маршруты ?
                #closedroproutes.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png') 
              .row
                .col-xs-10.col-xs-offset-1
                  h2 Пароль:
                  input(name='p',type='text') 
              .row
                .col-xs-11.col-xs-offset-1
                  button(type='submit',style='border:1px solid white;border-radius:4px;')
                    h5 Удалить
              script.
                $('#closedroproutes').click(function(){
                  $('#droproutesdb').slideToggle();
                }); 
          #updaterouteblock.row.hiddeninputs(style='background-color:#6faebf;')
            #updaterouteblockinserts.col-xs-12       
          script.
            function updateroutelist() {
                $('#updaterouteblockinserts').empty();
                console.log('requesting routes');
                request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                var DONE = this.DONE || 4;
                if (this.readyState === DONE){
                var index;
                parsed = JSON.parse(request.responseText);
                console.log(parsed);
                if(parsed.trouble === 1)
                {
                console.log('TROUBLE === 1');
                switch (parsed.mtext){
                case('db'):
                alert('Проблемы с базой данных');
                break;
                case('empty'):
                alert('В базе данных нет ни одной записи');
                return;
                break;
                }}
                else {
                //trouble === 0
                $('#updaterouteblockinserts').append("<div class='row'><div class='col-xs-10 col-xs-offset-1'><h2 style='color:white'>Выберите маршрут для редактирования</h2></div><div class='col-xs-1 closedialog' id='closeupdateroute'><img src='/bootstrap/images/cross_white.png'></div></div><script>$('#closeupdateroute').click(function(){$('#updaterouteblock').slideToggle();});<\/script>");
                for (var yy =0;yy<parsed.mbody.length;yy++){
                $('#updaterouteblockinserts').append("<div class='row route' onclick='routeupdate("+parsed.mbody[yy].id+");' id='route"+parsed.mbody[yy].id+"'><div class='col-xs-12' style='padding-left:0px;'><h2>"+parsed.mbody[yy].routename+"</h2></div></div>");
                }
                $('.hiddeninputs').css('display','none');
                $('#updaterouteblock').slideToggle();
                }
                }
                };
                request.open('POST', '/actions', true);
                request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                //Most libraries like jQuery/Prototype/Dojo do this
                request.send("actions=updateroutelist");}           
          #addrouteblock.row.hiddeninputs(style='background-color:#6faebf;')
            #addrouteblockinsert.col-xs-12 
              .row
                .col-xs-11
                  h2(style='color:white;') Добавляем маршрут
                #closeaddrouteblock.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png') 
                script.
                  $('#closeaddrouteblock').click(function(){$('#addrouteblock').slideToggle();});
              .row(style='background-color:#eee;margin-left:4vw;margin-right:4vw;border-radius:4px;padding:2vh;')
                 .col-xs-1
                   img(src='/bootstrap/images/circle_excl.png')  
                 .col-xs-11
                   h2 Подсказка
                   p(style='font-size:1.7vw;')
                     Ссылки вставляются с помощью тега &lta&gt &lt/a&gt
                   pre  &lta href='http://en.wikipedia.org/wiki/Cactus'&gt Кактусы &lt/a&gt
                   p(style='font-size:1.7vw;') 
                      Заголовки - &lth4&gt &lt/h4&gt  
                   pre  &lth4&gt Заголовок &lt/h4&gt 
                   p(style='font-size:1.7vw;')
                     Изображения вставляются как в блоге:
                   pre &ltdiv class='row'&gt&ltdiv style='height:70vh;padding:2vh;' class='col-xs-10 col-xs-offset-1'&gt&ltimg style='width:initial;height:70vh;position:absolute;' src='/postimages/&#35{post.img1}'&gt&lt/div&gt&lt/div&gt&ltdiv class='row'&gt&ltdiv style='padding-top:2vh;' class='col-xs-12 col-xs-offset-1'&gt&lth2 style='font-weight:bold;color:black;'&gt Текст комментария &lt/h2&gt&lt/div&gt&lt/div&gt
                   p(style='font-size:1.7vw;')
                     Начиная со второй фотографии увеличивайте циферку в &#35{post.img1} на один
              .row
                .col-xs-6(style='padding:2vh;')
                  h2(style='margin-left:0px;') Дополнительные фотографии :
              .row(style='display:none;')
                .col-xs-12
                  input#photonumroutes(type='text',name='photonum',value='0')    
              .row 
                .col-xs-4
                  button(type='button',id='addroutephoto',style='border:1px solid white;border-radius:4px;')
                    h5 Добавить
              .row
                #routeadditionalphotoinsert.col-xs-12 
              script.  
                 var photocount = 0;
                 $('#addroutephoto').click(function(){
                   photocount++
                   $('#routeadditionalphotoinsert').append("<div id='additionalphoto"+photocount+"' class='row'><div class='col-xs-6'><input class='form-control' type='file' style='margin:2vh;' id='additionalphoto"+photocount+"' name='additionalphoto"+photocount+"'></div><div id='closeadditionalphoto"+photocount+"' class='closedialog col-xs-1'><img src='/bootstrap/images/cross_white.png'></div><script>$('#closeadditionalphoto"+photocount+"').click(function(){$('#additionalphoto"+photocount+"').remove();photocount--;$('#photonumroutes').val(photocount);console.log(photocount);})<\/script></div>");
                   $('#photonumroutes').val(photocount);
                 });  
              .row
                 .col-xs-6(style='padding:2vh;')
                   h2(style='margin-left:0px;') Страна:
              .row
                .col-xs-8
                  input.form-control(id='routecountry',type='text',name='routecountry',style='line-height:2vw') 
              .row
                 .col-xs-6(style='padding:2vh;')
                   h2(style='margin-left:0px;') Название маршрута:
              .row
                .col-xs-8
                  input.form-control(id='routename',type='text',name='routename',style='line-height:2vw')            
              .row
                 .col-xs-6(style='padding:2vh;')
                   h2(style='margin-left:0px;') Текстовое описание маршрута:
              .row
                .col-xs-8
                  textarea#routebody.form-control(rows='7',name='routetextbody') 
              .row(style='display:none;')
                .col-xs-12
                  input#daynumroutes(type='text',name='daynum',value='0')     
              .row
                 .col-xs-12(style='padding:2vh;')
                   h2(style='margin-left:0px;') Таблица маршрута (день - программа)
               .row(style='display:none;')
                 .col-xs-12
                   input#routedays(type='text',name='routedays',value='0')    
               .row 
                 .col-xs-4
                   button(type='button',id='addrouteday',style='border:1px solid white;border-radius:4px;')
                     h5 Добавить день
               .row
                  #routeadddayinsert.col-xs-12 
               .row
                 .col-xs-12(style='padding:2vh;')
                   button(type='button',id='submitroutebutton',style='border:1px solid white;border-radius:4px;') 
                     h5(style='color:white;') Отправить 
               script.
                 var daycount = 0;
                 $('#addrouteday').click(function(){
                   daycount++
                   $('#routeadddayinsert').append("<div id='addday"+daycount+"' class='row'><div class='col-xs-12'><div class='row'><div class='row'><div class='col-xs-12'><h2>"+daycount+" ДЕНЬ</h2></div></div><div class='col-xs-8'><input class='form-control' type='text' style='margin:2vh;line-height:2vw;' name='nameaddday"+daycount+"'></div><div id='closeaddday"+daycount+"' class='closedialog col-xs-1'><img src='/bootstrap/images/cross_white.png'></div></div><div class='row'><div class='col-xs-8'><textarea name='bodyaddday"+daycount+"' class='form-control' rows='7'></textarea></div></div></div></div><script>$('#closeaddday"+daycount+"').click(function(){$('#addday"+daycount+"').remove();daycount--;$('#routedays').val(daycount);console.log(daycount);})<\/script></div>");
                   $('#daynumroutes').val(daycount);
                 });
                 function submitroute(){ 
                 var midbody;
                 for(var rr=0;rr<daycount;rr++)
                 { var rr2 = rr+1;
                   eval("var edh=$('#nameaddday"+rr+"').val();");
                   eval("var edb=$('#bodyaddday"+rr+"').val();");
                   if(rr === 0)
                   {
                   var dh ="<div class='row' style='border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;'><div class='col-xs-12'><h2>"+edh+"</h2></div></div>";
                   var db ="<div class='row' style='border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;text-align:justify;'><div class='col-xs-12'><p>"+edh+"</p></div></div>";
                   midbody = dh+db;
                   }
                   else
                   {
                   if(rr2 === daycount)
                   {
                    var dh ="<div class='row' style='border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;'><div class='col-xs-12'><h2>"+edh+"</h2></div></div>";
                   var db ="<div class='row' style='border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;text-align:justify;'><div class='col-xs-12'><p>"+edh+"</p></div></div>";
                   midbody = midbody+dh+db;
                   }
                   else {
                   var dh ="<div class='row' style='border-left:1px solid black;border-right:1px solid black;'><div class='col-xs-12'><h2>"+edh+"</h2></div></div>";
                   var db ="<div class='row' style='border-left:1px solid black;border-right:1px solid black;text-align:justify;'><div class='col-xs-12'><p>"+edh+"</p></div></div>";
                   midbody = midbody+dh+db;
                   }
                   }
                 }
                 var mainbody = $('#routebody').val();
                 var vcountry = $('#routecountry').val();
                 var vphotonum =$('#photonumroutes').val();
                 var vroutename =$('#routename').val();
                 mainbody = mainbody+midbody;
                 var formData = new FormData();
                 for(var zyz =0;zyz<photocount;zyz++)
                 {var zyh=zyz+1;
                 eval("var file = document.getElementById('additionalphoto"+zyh+"');");
                 eval("formData.append('additionalphoto"+zyh+"', file.files[0]);")
                 }
                 formData.append('actions','addruote');
                 formData.append('routebody',mainbody);
                 formData.append('country',vcountry);
                 formData.append('photonum',vphotonum);
                 formData.append('routename',vroutename);
                 formData.append('routedays',daycount);
                 //
                 request = new XMLHttpRequest();
                 request.onreadystatechange = function () {
                 var DONE = this.DONE || 4;
                 if (this.readyState === DONE){
                 var index;
                 parsed = JSON.parse(request.responseText);
                 console.log(parsed);
                 if(parsed.trouble === 1)
                 {
                 alert('Не получилось загрузить маршрут');}
                 else {
                 //trouble === 0
                 alert('Маршрут добавлен');
                 window.location='http://maleshin.com/routes'
                 }
                 }
                 };
                 request.open('POST', '/actions', true);
                 request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
                 request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                 //Most libraries like jQuery/Prototype/Dojo do this
                 request.send(formData);}
                 $('#submitroutebutton').click(function(){
                   submitroute();
                 });
          #booksblockoptions.row.hiddenoptions
            .col-xs-6.nb          
              #addbook.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_cross.png')    
                .col-xs-10(style='padding-left:0px;')
                  h2  Добавить книгу
              script.
                $('#addbook').click(function(){$('#addbooksblock').slideToggle();});      
          #addbooksblock.row.hiddeninputs(style='background-color:#6faebf;')
            #addbooksblockinsert.col-xs-12 
              .row
                .col-xs-11
                  h2(style='color:white;') Добавляем книгу
                #closeaddbooksblock.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png') 
                script.
                  $('#closeaddbooksblock').click(function(){$('#addbooksblock').slideToggle();});  
              .row(style='background-color:#eee;margin-left:4vw;margin-right:4vw;border-radius:4px;padding:2vh;')
                 .col-xs-1
                   img(src='/bootstrap/images/circle_excl.png')  
                 .col-xs-11
                   h2 Подсказка
                   p(style='font-size:1.7vw;')
                     Чтобы вставить в текст ссылку пользуйтесь, html тегом &lta&gt. Пример: нужно дать ссылку на статью про кактусы в википедии - пишем
                   pre  &lta href='http://en.wikipedia.org/wiki/Cactus'&gt Кактусы &lt/a&gt
                   p(style='font-size:1.7vw;') 
                     После href= в кавычках идет ссылка , а между тегами &lta&gt и &lt/a&gt текст который будет визуально выделен как ссылка и перенаправит читателя на указанный ресурс при нажатии
              .row
                .col-xs-11
                  h2 Название книги:
                  input(id='booksname',type='text',name='bookname') 
              .row
                .col-xs-11
                  h2 Автор:
                  input(id='booksauthor',type='text',name='author')
              .row
                .col-xs-11
                  h2 Комментарий:
                  textarea(class='form-control',id='bookscomment',name='comment')         
              .row
                .col-xs-11
                  button(type='button',class='addbook',onclick='addbook();',style='border:1px solid white;border-radius:4px;margin-top:2vh;')
                    h5 Добавить
              script.
                $('#closeaddalbumblock').click(function(){
                  $('#albumsblock').slideToggle();
                });
                $('.addbook').click(function(){
                var vname = $('#booksname').val();
                var vauthor = $('#booksauthor').val();
                var vcomment = $('#bookscomment').val();
                if(!vname||!vauthor||!vcomment) {
                alert('Заполните все поля');
                return;
                }
                request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                var DONE = this.DONE || 4;
                if (this.readyState === DONE){
                var index;
                parsed = JSON.parse(request.responseText);
                console.log(parsed);
                if(parsed.trouble === 1)
                {
                console.log('TROUBLE === 1');
                switch (parsed.mtext){
                case('db'):
                alert('Проблемы с базой данных');
                break;
                }}
                else {
                //trouble === 0
                alert('Книжка добавлена');
                $('#addbooksblock').slideToggle();
                $('#booksname').val('');
                $('#booksauthor').val('');
                $('#bookscomment').val('');
                }
                }
                };
                request.open('POST', '/actions', true);
                request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                //Most libraries like jQuery/Prototype/Dojo do this
                request.send("actions=addbook&bookname="+vname+"&author="+vauthor+"&comment="+vcomment);});
          #blogblockoptions.row.hiddenoptions(style='display:block;')
            .col-xs-6.nb          
              #addpost.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_cross.png')      
                .col-xs-10(style='padding-left:0px;')
                  h2  Добавить запись 
              #updatepost.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_text_edit.png')      
                .col-xs-10(style='padding-left:0px;')
                  h2  Редактировать запись 
              script.
                $('#updatepost').click(function(){updatepostlist();});             
              #removepost.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_minus.png')     
                .col-xs-10(style='padding-left:0px;')
                  h2  Удалить запись    
              script.
                $('#removepost').click(function(){$('.hiddeninputs').css('display','none');removepostlist();$('#removepostblock').slideToggle();});       
            .col-xs-6.stats
              .row
                .col-xs-12
                  .row
                    h2(style='color:#c35') Статистика
                    |            
                    h2  ЗАПИСЕЙ : #{postsn}
                    |            
                    h2(style='color:gray;')  Необходимо сделать статистику просмотров 
          script.
                function updatepostlist() {
                $('#updatepostblockinserts').empty();
                console.log('requesting posts');
                request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                var DONE = this.DONE || 4;
                if (this.readyState === DONE){
                var index;
                parsed = JSON.parse(request.responseText);
                console.log(parsed);
                if(parsed.trouble === 1)
                {
                console.log('TROUBLE === 1');
                switch (parsed.mtext){
                case('db'):
                alert('Проблемы с базой данных');
                break;
                case('empty'):
                alert('В базе данных нет ни одной записи');
                return;
                break;
                }}
                else {
                //trouble === 0
                $('#updatepostblockinserts').append("<div class='row'><div class='col-xs-10 col-xs-offset-1'><h2 style='color:white'>Выберите запись для редактирования</h2></div><div class='col-xs-1 closedialog' id='closeupdatepost'><img src='/bootstrap/images/cross_white.png'></div></div><script>$('#closeupdatepost').click(function(){$('#updatepostblock').slideToggle();});<\/script>");
                for (var yy =0;yy<parsed.mbody.length;yy++){
                $('#updatepostblockinserts').append("<div class='row post' onclick='postupdate("+parsed.mbody[yy].id+");' id='post"+parsed.mbody[yy].id+"'><div class='col-xs-2' style='padding-right:0px;'><h2 style='color:white;'>"+parsed.mbody[yy].date.day+"."+parsed.mbody[yy].date.month+"."+parsed.mbody[yy].date.year+"</h2></div><div class='col-xs-10' style='padding-left:0px;'><h2>"+parsed.mbody[yy].title+"</h2></div></div>");
                }
                $('.hiddeninputs').css('display','none');
                $('#updatepostblock').slideToggle();
                }
                }
                };
                request.open('POST', '/actions', true);
                request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                //Most libraries like jQuery/Prototype/Dojo do this
                request.send("actions=updatepostlist");} 
                function removepostlist() {
                console.log('requesting posts');
                request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                var DONE = this.DONE || 4;
                if (this.readyState === DONE){
                var index;
                parsed = JSON.parse(request.responseText);
                console.log(parsed);
                if(parsed.trouble === 1)
                {
                console.log('TROUBLE === 1');
                switch (parsed.mtext){
                case('db'):
                alert('Проблемы с базой данных');
                break;
                case('empty'):
                alert('В базе данных нет ни одной записи');
                break;
                }}
                else {
                //trouble === 0
                for (var yy =0;yy<parsed.mbody.length;yy++){
                $('#removepostblockinserts').append("<div class='row post' onclick='removepost("+parsed.mbody[yy].id+")' id='post"+parsed.mbody[yy].id+"'><div class='col-xs-2' style='padding-right:0px;'><h2 style='color:white;'>"+parsed.mbody[yy].date.day+"."+parsed.mbody[yy].date.month+"."+parsed.mbody[yy].date.year+"</h2></div><div class='col-xs-10' style='padding-left:0px;'><h2>"+parsed.mbody[yy].title+"</h2></div></div>");
                }
                }
                }
                };
                request.open('POST', '/actions', true);
                request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                //Most libraries like jQuery/Prototype/Dojo do this
                request.send("actions=updatepostlist");} 
                function removepost(id) {
                if( confirm('Удалить запись?') )
                {console.log('requesting posts');
                request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                var DONE = this.DONE || 4;
                if (this.readyState === DONE){
                var index;
                parsed = JSON.parse(request.responseText);
                console.log(parsed);
                if(parsed.trouble === 1)
                {
                console.log('TROUBLE === 1');
                alert('Ошибка сервера');
                }
                else {
                //trouble === 0
                eval("$('#post"+id+"').empty();");
                var atext = "<div class='col-xs-12 style='text-align:center'><h2 style='color:white'>ЗАПИСЬ УДАЛЕНА</h2></div>";
                eval("$('#post"+id+"').append(atext);");
                }
                }
                };
                request.open('POST', '/actions', true);
                request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                //Most libraries like jQuery/Prototype/Dojo do this
                request.send("actions=removepost&pid="+id);}
                else{
                return;
                }}            
          #updatepostblock.row.hiddeninputs(style='background-color:#6faebf;')
            #updatepostblockinserts.col-xs-12
          #removepostblock.row.hiddeninputs(style='background-color:#6faebf;')
            #removepostblockinserts.col-xs-12  
              .row
                .col-xs-10.col-xs-offset-1
                  h2(style='color:white;') Выберите запись которую нужно удалить
                #closeremovepost.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png')
              script.
                $('#closeremovepost').click(function(){
                  $('#removepostblock').slideToggle();
                });    
              #removeposts.row
                .col-xs-1
                  img(src='/bootstrap/images/circle_minus_white.png')   
                .col-xs-10
                  h2 Удалить все записи           
          #addpostblock.row.hiddeninputs(style='background-color:#6faebf;') 
            form(action='/actions',id='mainform',role='form',method='post', enctype='multipart/form-data')
             .col-xs-12
               .row
                 .col-xs-11
                   h2(style='color:white;') Добавляем запись 
                 #closeaddpostblock.col-xs-1.closedialog
                   img(src='/bootstrap/images/cross_white.png')
                 script.
                   $('#closeaddpostblock').click(function(){
                     $('#addpostblock').slideToggle();
                   });  
               .row(style='background-color:#eee;margin-left:4vw;margin-right:4vw;border-radius:4px;padding:2vh;margin-top:3vh')
                 .col-xs-1
                   img(src='/bootstrap/images/circle_excl.png')  
                 .col-xs-11
                   h2 Подсказка
                   p(style='font-size:1.7vw;') 
                     Начинайте абзац с тега &ltp&gt и заканчвайте  тегом &lt/p&gt - это автоматически вставит красную строку и добавит место между абзацами.
                   p(style='font-size:1.7vw;') Выделение ключевых фрагментов текста (фраза или предложение) помогает читателю ориентироваться и работает как превью у фотографий; чтобы вставить такой блок (в нем содержится повторение части оригинального текста) необходимо завершить абзац (один в другой положить нельзя , только по очереди) и начать абзац обозначив в нем класс attention таким образом : <pre>&ltp class='attention' &gt Ключевая фраза &lt/p&gt</pre>
                   p(style='font-size:1.7vw;') Для заголовков используйте теги &lth4&gt &lt/h4&gt
                   p(style='font-size:1.7vw;')  Чтобы вставить в текст ссылку пользуйтесь, html тегом &lta&gt. Пример: нужно дать ссылку на статью про кактусы в википедии - пишем
                   pre &lta href='http://en.wikipedia.org/wiki/Cactus'&gt Кактусы &lt/a&gt
                   p(style='font-size:1.7vw;')  После href= в кавычках идет ссылка , а между тегами &lta&gt и &lt/a&gt текст который будет визуально выделен как ссылка и перенаправит читателя на указанный ресурс при нажатии
                   p(style='font-size:1.7vw;') Добавить фотографию в текст можно следующим образом : между абзацми вставьте приведенный ниже код , увеличивая цифру ( в &#35{post.img1} ) на один начиная со второй. 
                   pre &ltdiv class='row'&gt&ltdiv style='height:70vh;padding:2vh;' class='col-xs-10 col-xs-offset-1'&gt&ltimg style='width:initial;height:70vh;position:absolute;' src='/postimages/&#35{post.img1}'&gt&lt/div&gt&lt/div&gt&ltdiv class='row'&gt&ltdiv style='padding-top:2vh;' class='col-xs-12 col-xs-offset-1'&gt&lth2 style='font-weight:bold;color:black;'&gt Текст комментария &lt/h2&gt&lt/div&gt&lt/div&gt
               .row(style='display:none;')
                 .col-xs-12
                   input#hiddeninput(type='text',name='actions',value='newpost')
               .row 
                 .col-xs-6(style='padding:2vh;')
                   h2(style='margin-left:0px;') Заглавное изображение:
               .row    
                 .col-xs-6
                   input.form-control(type='file', name='headimage') 
               script.
                 $('#additionalimages').change(function(){
                  alert('Скопируйте и вставьте между абзацами ')
                 });    
               .row
                 .col-xs-6(style='padding:2vh;')
                   h2(style='margin-left:0px;') Дополнительные фотографии :
               .row(style='display:none;')
                 .col-xs-12
                   input#photonum(type='text',name='photonum',value='0')    
               .row 
                 .col-xs-4
                   button(type='button',id='addpostphoto',style='border:1px solid white;border-radius:4px;')
                     h5 Добавить
               .row
                  #additionalphotoinsert.col-xs-12                   
               script.
                 var photocount = 0;
                 $('#addpostphoto').click(function(){
                   photocount++
                   $('#additionalphotoinsert').append("<div id='additionalphoto"+photocount+"' class='row'><div class='col-xs-6'><input class='form-control' type='file' style='margin:2vh;' name='additionalphoto"+photocount+"'></div><div id='closeadditionalphoto"+photocount+"' class='closedialog col-xs-1'><img src='/bootstrap/images/cross_white.png'></div><script>$('#closeadditionalphoto"+photocount+"').click(function(){$('#additionalphoto"+photocount+"').remove();photocount--;$('#photonum').val(photocount);console.log(photocount);})<\/script></div>");
                   $('#photonum').val(photocount);
                 });      
               .row
                 .col-xs-3(style='padding:2vh;')
                   h2(style='margin-left:0px') Заголовок:    
               .row
                 .col-xs-8
                   textarea#gettitle.form-control
                   //
                     button#gettitlebutton(type='button') GET TITLE   
               .row(style='display:none;')
                 .col-xs-12
                   input#invisibleinput(name='postbody',type='text')
               .row(style='display:none;')
                 .col-xs-12
                   input#vtitle(name='vtitle',type='text')
               .row
                 .col-xs-6(style='padding:2vh;')
                   h2(style='margin-left:0px;') Основной текст:
               .row
                 .col-xs-8
                   textarea#getbody.form-control(rows='7')
                   //
                     button#getbodybutton(type='button') GET BODY   
               .row
                 .col-xs-12(style='padding:2vh;')
                   button(type='button',id='sendbutton',style='border:1px solid white;border-radius:4px;') 
                     h5(style='color:white;') Отправить  
               .row(style='background-color:#82d1e3;')
                 #grab.col-xs-12      
          #dropdb.row(style='display:none;background-color:#ca2c28;padding-top:3vh;')
            form(action='/drop/posts',method='post',role='form')  
              .row
                .col-xs-1(style='text-align:right;')
                  img(src='/bootstrap/images/circle_excl_white.png')
                .col-xs-10
                  h2(style='color:white;') Удалить все посты ?
                #closedropposts.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png') 
              .row
                .col-xs-10.col-xs-offset-1
                  h2 Пароль:
                  input(name='p',type='text') 
              .row
                .col-xs-11.col-xs-offset-1
                  button(type='submit',style='border:1px solid white;border-radius:4px;')
                    h5 Удалить
              script.
                $('#closedropposts').click(function(){
                  $('#dropdb').slideToggle();
                });  
              //
                .col-xs-3
                  input(name='p',type='text')
                .col-xs-3
                  button(style='border:1px solid white;border-radius:4px;background-color:#c35;',type='submit') 
                    h5(style='color:white;') Удалить
          #gallblockoptions.row.hiddenoptions
            .col-xs-6.nb          
              #addphoto.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_cross.png')
                .col-xs-10(style='padding-right:0px;')
                  h2  Добавить фото     
              #albums.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_cross.png')
                .col-xs-10(style='padding-right:0px;')
                  h2  Добавить альбом 
              #albumsremove.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_minus.png')
                .col-xs-10(style='padding-right:0px;')
                  h2  Удалить альбом             
              #addvideo.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_cross.png')         
                .col-xs-10(style='padding-right:0px;')
                  h2  Добавить видео  
            .col-xs-6.stats
              .row
                .col-xs-12
                  .row
                    h2(style='color:#c35') Статистика          
                    h2  Фотографий: #{imgn}             
                    h2  Альбомов : #{albumn} 
                    h2  Видео : #{videon}       
          script.
            $('.addalbum').click(function(){
            request = new XMLHttpRequest();
            request.onreadystatechange = function () {
            var DONE = this.DONE || 4;
            if (this.readyState === DONE){
            var index;
            parsed = JSON.parse(request.responseText);
            console.log(parsed);
            if(parsed.trouble === 1)
            {
            console.log('TROUBLE === 1');
            switch (parsed.mtext){
            case('empty'):
            $('#albumsblockinsert').append("<div class='row addalbum addsmth' id='secondaddalbum'><div class='col-xs-1'><img src='/bootstrap/images/circle_cross.png'></div><div class='col-xs-11'><h2>Добавить альбом</h2></div></div>");
            $('#albumsblock').slideToggle();
            console.log('was supposed to slidetoggle ALBUMSBLOCK');
            break;
            case('db'):
            $('#albumsblockinsert').append("<div class='row' ><div class='col-xs-1'><img src='/bootstrap/images/circle_excl.png'></div><div class='col-xs-11'><h2>Проблемы с базой данных</h2></div></div>");
            $('#albumsblock').slideToggle();
            console.log('was supposed to slidetoggle ALBUMSBLOCK');
            break;
            }}
            else {
            //trouble === 0
            for (var i in parsed.results) {
            $('#albumsblockinsert').append("<div class='row' style='border-bottom:1px solid #eee;'><div class='col-xs-12'>"+i+"</div></div>");
            $('#albumsblock').slideToggle();
            console.log('was supposed to slidetoggle ALBUMSBLOCK');
            }
            }
            }
            };
            request.open('POST', '/actions', true);
            request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            //Most libraries like jQuery/Prototype/Dojo do this
            request.send("actions=albums");          });
            $('#secondaddalbum').click(function(){

            $('#addphotoblock').slideToggle();
            });
            function addalbumfunction(){
            var addingconfrm;
            console.log('CREATING FIRST ALBUM');
            var valbumname = $('#albumnameinput').val();
            console.log('valbumname is: '+valbumname);
            if(!valbumname)
            {
             valbumname = $('#albumnameinputsecond').val();
             addingconfrm = 1;
             console.log('valbumname second try: '+valbumname);
            }
            if(!valbumname)
            {
             return
            }
            request = new XMLHttpRequest();
            request.onreadystatechange = function () {
            var DONE = this.DONE || 4;
            if (this.readyState === DONE){
            var index;
            parsed = JSON.parse(request.responseText);
            console.log(parsed);
            if(parsed.trouble === 1)
            {
            console.log('TROUBLE === 1');
            switch (parsed.mtext){
            case('empty'):
            alert('DB Error while adding album')
            break;
            case('db'):
            alert('DB Error')
            break;
            }}
            else {
            //trouble === 0
            alert('Альбом создан');
            if(addingconfrm === 1)
            {
            for (yy=0;yy<parsed.mbody.length;yy++){
            console.log('loop is running');
            $('#addphotoblockinsert').append("<div class='row'><div class='col-xs-3 col-xs-offset-1'><h2 style='color:white;'>"+parsed.mbody[yy].albumname+"</h2></div><div class='col-xs-4' style='text-align:center;'><h2>Добавить одно</h2></div><div class='col-xs-4' id='bulkalbum"+parsed.mbody[yy].id+"' style='text-align:center;'><h2>Добавить несколько</h2></div></div><div class='row' id='album"+parsed.mbody[yy].id+"' style='background-color:#6faebf;display:none;'><div class='col-xs-12'><form method='post' action='/actions' role='form' enctype='multipart/form-data'><div class='row'><div class='col-xs-10 col-xs-offset-1'><h2 style='color:white;'>Загрузка нескольких изображений</h2></div><div class='col-xs-1 closedialog' id='closealbum"+parsed.mbody[yy].id+"'><img src='/bootstrap/images/cross_white.png'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><h2>Страна:</h2><input name='country' type='text'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><h2>Файлы</h2><input type='file' multiple name='photo'></div></div><div class='row' style='display:none;'><div class='col-xs-11 col-xs-offset-1'><input type='text' name='aid' value='"+parsed.mbody[yy].id+"'><input type='text' name='actions' value='addphotobulk'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><button type='submit' style='border-radius:4px;'><h5>Загрузить</h5></button></div></div></form></div></div><script>$('#closealbum"+parsed.mbody[yy].id+"').click(function(){$('#album"+parsed.mbody[yy].id+"').slideToggle();});$('#bulkalbum"+parsed.mbody[yy].id+"').click(function(){$('#album"+parsed.mbody[yy].id+"').slideToggle();});<\/script>");
            }
            $('#albumnameinputsecond').val('');
            $('#addextraalbumblock').slideToggle();
            }
            }
            }
            };
            request.open('POST', '/actions', true);
            request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            //Most libraries like jQuery/Prototype/Dojo do this
            request.send("actions=addalbum&albumname="+valbumname);}
            $('#secondaddalbum').click(function(){
            $('#addphotoblock').slideToggle();
            });
          #addphotoblock.row.hiddeninputs(style='background-color:#6faebf;')
            #addphotoblockinsert.col-xs-12.simplyhidden
              .row
                .col-xs-10.col-xs-offset-1
                  h2(style='color:white;') Выберите альбом или создайте новый
                .col-xs-1
                  img(src='/bootstrap/images/cross_white.png')
              .row
                .col-xs-1
                  img(src='/bootstrap/images/circle_cross_white.png')   
                .col-xs-10
                  h2 Создать альбом 
          #albumsblock.row.hiddeninputs(style='background-color:#6faebf;')
            #albumsblockinsert.col-xs-12 
              .row
                .col-xs-11
                  h2(style='color:white;') Добавляем альбом
                #closeaddalbumblock.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png') 
              .row
                .col-xs-11
                  h2 Название альбома:
                  input(id='albumnameinputsecond',type='text') 
              .row
                .col-xs-11
                  button(type='button',class='addalbumbutton',onclick='addalbumfunction();',style='border:1px solid white;border-radius:4px;')
                    h5 Создать
              script.
                $('#closeaddalbumblock').click(function(){
                  $('#albumsblock').slideToggle();
                });
          #albumsremoveblock.row.hiddeninputs(style='background-color:#6faebf;')
            #albumsremoveblockinsert.col-xs-12 
              .row
                .col-xs-11
                  h2(style='color:white;') Удалить альбом
                #closeremovealbumblock.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png') 
              script.
                $('#closeremovealbumblock').click(function(){
                  $('#albumsremoveblock').slideToggle();
                });             
                  
          #addvideoblock.row.hiddeninputs
            #addvideoblockinsert.col-xs-12
          #contactsblockoptions.row.hiddenoptions
            .col-xs-6.nb          
              #editcontacts.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_text_edit.png')         
                .col-xs-10(style='padding-right:0px;')
                  h2  Редактировать контакты 
          #addbooksblock.row.hiddeninputs(style='background-color:#6faebf;')
            #addbooksblockinsert.col-xs-12 
              .row
                .col-xs-11
                  h2(style='color:white;') Добавляем книгу
                #closeaddbooksblock.col-xs-1.closedialog
                  img(src='/bootstrap/images/cross_white.png') 
              .row(style='background-color:#eee;margin-left:4vw;margin-right:4vw;border-radius:4px;padding:2vh;')
                 .col-xs-1
                   img(src='/bootstrap/images/circle_excl.png')  
                 .col-xs-11 
                   h2 Подсказка
                   p(style='font-size:1.7vw;')  Чтобы вставить в текст ссылку пользуйтесь, html тегом &lta&gt. Пример: нужно дать ссылку на статью про кактусы в википедии - пишем
                   pre &lta href='http://en.wikipedia.org/wiki/Cactus'&gt Кактусы &lt/a&gt
                   p(style='font-size:1.7vw;')  После href= в кавычках идет ссылка , а между тегами &lta&gt и &lt/a&gt текст который будет визуально выделен как ссылка и перенаправит читателя на указанный ресурс при нажатии
              .row
                .col-xs-11
                  h2 Название книги:
                  input(id='booksname',type='text',name='bookname') 
              .row
                .col-xs-11
                  h2 Автор:
                  input(id='booksauthor',type='text',name='author')
              .row
                .col-xs-11
                  h2 Комментарий:
                  textarea(class='form-control',id='bookscomment',name='comment')         
              .row
                .col-xs-11
                  button(type='button',class='addbook',onclick='addbook();',style='border:1px solid white;border-radius:4px;margin-top:2vh;')
                    h5 Добавить
              script.
                $('#closeaddalbumblock').click(function(){
                  $('#albumsblock').slideToggle();
                });
                $('.addbook').click(function(){
                var vname = $('#booksname').val();
                var vauthor = $('#booksauthor').val();
                var vcomment = $('#bookscomment').val();
                if(!vname||!vauthor||!vcomment) {
                alert('Заполните все поля');
                return;
                }
                request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                var DONE = this.DONE || 4;
                if (this.readyState === DONE){
                var index;
                parsed = JSON.parse(request.responseText);
                console.log(parsed);
                if(parsed.trouble === 1)
                {
                console.log('TROUBLE === 1');
                switch (parsed.mtext){
                case('db'):
                alert('Проблемы с базой данных');
                break;
                }}
                else {
                //trouble === 0
                alert('Книжка добавлена');
                $('#addbooksblock').slideToggle();
                $('#booksname').val('');
                $('#booksauthor').val('');
                $('#bookscomment').val('');
                }
                }
                };
                request.open('POST', '/actions', true);
                request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                //Most libraries like jQuery/Prototype/Dojo do this
                request.send("actions=addbook&bookname="+vname+"&author="+vauthor+"&comment="+vcomment);});             
          #aboutblockoptions.row.hiddenoptions
            .col-xs-6.nb          
              #editabout.row.addsmth
                .col-xs-2(style='text-align:center;')
                  img(src='/bootstrap/images/circle_text_edit.png')         
                .col-xs-10(style='padding-right:0px;')
                  h2(style='margin-left:0px;')  Редактировать "О проекте"  
          #aboutblockset.row.hiddeninputs(style='background-color:#6faebf;')
            .col-xs-12
              .row(style='background-color:#eee;margin-left:4vw;margin-right:4vw;border-radius:4px;padding:2vh;margin-top:3vh')
                 .col-xs-1
                   img(src='/bootstrap/images/circle_excl.png')  
                 .col-xs-11
                   h2 Подсказка
                   p(style='font-size:1.7vw;text-indent:0px;') Для заголовков используйте теги &lth4&gt &lt/h4&gt , абзацы как и везде создаются с помощью тега &ltp&gt&lt/p&gt. После вашего ознакомления с общей концепцией мы приведем детали и в том числе страничку "О проекте" к соответствию вашим будущим пожеланиям.                  
              form(role='form',method='post',action='/actions')
                .row
                  .col-xs-12(style='padding:2vh')
                    h2 Текст "Опроекте":
                .row
                  .col-xs-8
                    textarea.form-control(rows='7',name='abody')
                    input(style='display:none;',name='actions',value='setabout')
                .row  
                  .col-xs-12(style='padding:2vh;')
                    button(type='submit',style='border:1px solid white;border-radius:4px;')
                      h5 Сохранить
          #contactsblockset.row.hiddeninputs(style='background-color:#6faebf;')
            .col-xs-12
              .row(style='background-color:#eee;margin-left:4vw;margin-right:4vw;border-radius:4px;padding:2vh;margin-top:3vh')
                 .col-xs-1
                   img(src='/bootstrap/images/circle_excl.png')  
                 .col-xs-11
                   h2 Подсказка
                   p(style='font-size:1.7vw;text-indent:0px;') Скопируйте приведенный ниже код и вставьте его в поле ввода текста,  укажите ключевую информацию в тегах &lth4&gt: 
                   pre &lth4&gtТелефон: вставьте номер &lt/h4&gt&lth4&gtEmail: вставьте почту &lt/h4&gt&ltp&gt вставьте текст &lt/p&gt
                   p(style='font-size:1.7vw;text-indent:0px;') Чтобы добавить абзац, заключите текст в теги: 
                   pre &ltp&gt текст абзаца &lt/p&gt 
                   p(style='font-size:1.7vw;text-indent:0px;') это добавит красную строку и место между абзацами.
              form(role='form',method='post',action='/ations')
              .row
                .col-xs-12(style='padding:2vh')
                  h2 Текст "Опроекте":
              .row
                .col-xs-8
                  textarea.form-control(rows='7',name='cbody')
                  input(style='display:none;',name='actions',value='setcontacts')
              .row  
                .col-xs-12(style='padding:2vh;')
                  button(type='submit',style='border:1px solid white;border-radius:4px;')
                    h5 Сохранить          

          script.
            $('#editabout').click(function(){
              $('#aboutblockset').slideToggle();
            });
            $('#editcontacts').click(function(){
              $('#contactsblockset').slideToggle();
            });
            $('#routesblock').click(function(){
              $('.hiddenoptions').css('display','none');
              $('.hidedeninputs').css('display','none');
              $('#routesblockoptions').slideToggle();
            }); 
            $('#contactsblock').click(function(){
              $('.hiddenoptions').css('display','none');
              $('.hiddeninputs').css('display','none');
              $('#contactsblockoptions').slideToggle();
            });  
            $('#aboutblock').click(function(){
              $('.hiddenoptions').css('display','none');
              $('.hiddeninputs').css('display','none');
              $('#aboutblockoptions').slideToggle();
            }); 
            $('#gallblock').click(function(){
              var x = $('#gallblockoptions').css('display');
              var y = $('#addphotoblock').css('display');
              var z = $('#addphotoblockinsert').css('display');
              if(x === 'block')
              {
               if(z !== 'none')
               {
                 $('#addphotoblockinsert').slideToggle();
               }
               if(y !== 'none')
               {
                 $('#addphotoblock').slideToggle();
               }
              }
              $('.hiddenoptions').css('display','none');
              $('.hiddeninputs').css('display','none');
              $('#gallblockoptions').slideToggle();
            }); 
            $('#booksblock').click(function(){
              $('.hiddenoptions').css('display','none');
              $('.hiddeninputs').css('display','none');
              $('#booksblockoptions').slideToggle();
            }); 
            $('#blogblock').click(function(){
              $('.hiddenoptions').css('display','none');
              $('.hiddeninputs').css('display','none');
              $('#blogblockoptions').slideToggle();
            }); 
            $('#addphoto').click(function(){
            request = new XMLHttpRequest();
            request.onreadystatechange = function () {
            var DONE = this.DONE || 4;
            if (this.readyState === DONE){
            var index;
            parsed = JSON.parse(request.responseText);
            console.log(parsed);
            if(parsed.trouble === 1)
            {
            console.log('TROUBLE === 1');
            if($('#addphotoblock').css('display')!='none'){
            console.log($('#addphotoblock').css('display'));
            $('#addphotoblock').slideToggle();
            }
            $('#addphotoblockinsert').empty();
            switch (parsed.mtext){
            case('empty'):
            console.log('should append some text');
            $('#addphotoblockinsert').append("<div class='row'><div  class='col-xs-1' style='text-align:right;'><img src='/bootstrap/images/circle_excl_white.png'></div><div class='col-xs-10'><h2 style='color:white;'>Чтобы начать добавлять фотографии, добавьте альбом</h2></div><div class='col-xs-1 closedialog' id='closedialog'><img src='/bootstrap/images/cross_white.png'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><h2>Название альбома:</h2><input id='albumnameinputsecond' type='text'></input></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><button type='button' class='addalbumbutton' onclick='addalbumfunction();' style='border:1px solid white;border-radius:4px;'><h5>Создать</h5></button></div></div>");
            var x ="<script>$('#closedialog').click(function(){console.log('closing something');$('#addphotoblockinsert').slideToggle();$('#addphotoblock').slideToggle();});<\/script>";
            $('#addphotoblockinsert').append(x);
            console.log(x);
            console.log('after insert main is: '+$('#addphotoblock').css('display')+', child is: '+$('#addphotoblockinsert').css('display'));
            $('#addphotoblock').slideToggle();
            $('#addphotoblockinsert').slideToggle();
            console.log('toggled both after inserts');
            break;
            }}
            else {
            //trouble === 0
            if($('#addphotoblock').css('display')!='none'){
            console.log($('#addphotoblock').css('display'));
            $('#addphotoblock').slideToggle();
            }
            $('#addphotoblockinsert').empty();
            $('#addphotoblockinsert').append("<div class='row'><div class='col-xs-10 col-xs-offset-1'><h2 style='color:white'>Выберите альбом или создайте новый</h2></div><div class='col-xs-1 closedialog' id='closephotoinserts'><img src='/bootstrap/images/cross_white.png'></div></div><div class='row' id='addextraalbum'><div class='col-xs-1' style='text-align:right;'><img src='/bootstrap/images/circle_cross.png'></div><div class='col-xs-10'><h2>Создать альбом</h2></div></div><div class='row' id='addextraalbumblock' style='margin-top:2vh;margin-bottom:2vh;display:none;'><div class='col-xs-10 col-xs-offset-1'><div class='row' style='padding-top:2vh;padding-bottom:2vh;background-color:#ddd;border-radius:4px;'><div class='col-xs-12'><div class='row'></div><div class='col-xs-11'><h2>Название альбома:</h2><input id='albumnameinputsecond' type='text'></div><div class='col-xs-1 closedialog' id='closeaddextraalbumblock'><img src='/bootstrap/images/cross.png'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><button type='button' class='addalbumbutton' onclick='addalbumfunction();' style='border:1px solid white;border-radius:4px;'><h5>Создать</h5></button></div></div></div></div></div></div><script>$('#closephotoinserts').click(function(){$('#addphotoblockinsert').slideToggle();$('#addphotoblock').slideToggle();});$('#addextraalbum').click(function(){$('#addextraalbumblock').slideToggle();});$('#closeaddextraalbumblock').click(function(){$('#addextraalbumblock').slideToggle();});<\/script>");
            console.log('entering the loop');
            for (yy=0;yy<parsed.results.length;yy++){
            console.log('loop is running');
            $('#addphotoblockinsert').append("<div class='row'><div class='col-xs-3 col-xs-offset-1'><h2 style='color:white;'>"+parsed.results[yy].albumname+"</h2></div><div class='col-xs-4' style='text-align:center;'><h2>Добавить одно</h2></div><div class='col-xs-4' id='bulkalbum"+parsed.results[yy].id+"' style='text-align:center;'><h2>Добавить несколько</h2></div></div><div class='row' id='album"+parsed.results[yy].id+"' style='background-color:#6faebf;display:none;'><div class='col-xs-12'><form method='post' action='/actions' role='form' enctype='multipart/form-data'><div class='row'><div class='col-xs-10 col-xs-offset-1'><h2 style='color:white;'>Загрузка нескольких изображений</h2></div><div class='col-xs-1 closedialog' id='closealbum"+parsed.results[yy].id+"'><img src='/bootstrap/images/cross_white.png'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><h2>Страна:</h2><input name='country' type='text'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><h2>Файлы</h2><input type='file' multiple name='photo'></div></div><div class='row' style='display:none;'><div class='col-xs-11 col-xs-offset-1'><input type='text' name='aid' value='"+parsed.results[yy].id+"'><input type='text' name='actions' value='addphotobulk'></div></div><div class='row'><div class='col-xs-11 col-xs-offset-1'><button type='submit' style='border-radius:4px;'><h5>Загрузить</h5></button></div></div></form></div></div><script>$('#closealbum"+parsed.results[yy].id+"').click(function(){$('#album"+parsed.results[yy].id+"').slideToggle();});$('#bulkalbum"+parsed.results[yy].id+"').click(function(){$('#album"+parsed.results[yy].id+"').slideToggle();});<\/script>");
            }
            $('#addphotoblock').slideToggle();
            $('#addphotoblockinsert').slideToggle();
            }
            }
            };
            request.open('POST', '/misc', true);
            request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            //Most libraries like jQuery/Prototype/Dojo do this
            request.send("cause=albums");});
            $('#sendbutton').click(function(){
            gettitle();
            getbody();
            $('#mainform').submit();
            })
            $('#removeposts').click(function(){
            $('#dropdb').slideToggle();
            window.location='#dropdb';
            });
            $('#addpost').click(function(){
            $('#addpostblock').slideToggle();
            window.location='#addpostblock';
            });
            $('#getbodybutton').click(getbody);
            function getbody (){
            alert('GETTING THAT BODY');
            var x=$('#hiddeninput').val();
            console.log("HIDDEN INPUT IS: "+x);
            var vbody = $('#getbody').val();
            vbody = vbody.replace(/\r|\n|\r\n/g, '<br>')
            console.log('we are in get body and body is:'+vbody);
            var dd= new Date();
            var vday = dd.getDate();
            var vmonth= dd.getMonth()+1;
            var vyear = dd.getUTCFullYear();
            var vdate = vday+'.'+vmonth+'.'+vyear;
            if(vbody)
            {if(!$('#invisibleinput').val())
            {
            $('#invisibleinput').val("<div class='row text'><div class='col-xs-12' style='padding:0px;'><h5>"+vdate+"</h5>"+vbody+"</div></div>");}
            else
            {
            var previoustext = $('#invisibleinput').val();
            var newtext = previoustext+"<div class='row text'><div class='col-xs-12' style='padding:0px;'>"+vbody+"</div></div>";
            $('#invisibleinput').val(newtext);
            console.log('NOT EMPTY , INSERTING: '+newtext);
            }
            $('#grab').append("<div class='row text'><div class='col-xs-12' style='padding:0px;'>"+vbody+"</div></div>");
            window.location='#grab';
            }
            else
            {}
            }
            $('#gettitlebutton').click(gettitle);
            function gettitle (){
            var vtitle = $('#gettitle').val();
            if (vtitle)
            {
            $('#vtitle').val(vtitle);
            $('#gettitlebutton').attr('disabled');
            $('#grab').append("<div class='row' id='title'><div class='col-xs-12' style='padding:0px;'><h1>"+vtitle+"</h1></div></div>");
            window.location='#grab';
            }
            else
            {}         
            }
            function getalbums(){
            request = new XMLHttpRequest();
            request.onreadystatechange = function () {
            var DONE = this.DONE || 4;
            if (this.readyState === DONE){
            var index;
            parsed = JSON.parse(request.responseText);
            console.log(parsed);
            if(parsed.trouble === 1)
            {
            console.log('TROUBLE === 1');
            switch (parsed.mtext){
            case('empty'):
            $('#albumsremoveblockinsert').append("<div class='row' ><div class='col-xs-1'><img src='/bootstrap/images/circle_excl.png'></div><div class='col-xs-11'><h2>Нет альбомов</h2></div></div>");
            break;
            case('db'):
            $('#albumsremoveblockinsert').append("<div class='row' ><div class='col-xs-1'><img src='/bootstrap/images/circle_excl.png'></div><div class='col-xs-11'><h2>Проблемы с базой данных</h2></div></div>");
            break;
            }}
            else {
            //trouble === 0
            for (yy=0;yy<parsed.results.length;yy++){
            $('#albumsremoveblockinsert').append("<div class='row' id='remconf"+parsed.results[yy].id+"'><div class='col-xs-9'><h2>"+parsed.results[yy].albumname+"</h2></div><div class='col-xs-3 closedialog'><img src='/bootstrap/images/cross_white.png'></div></div><div class='row' id='confblock"+parsed.results[yy].id+"' style='display:none;'><div class='col-xs-6' id='rem"+parsed.results[yy].id+"' style='background-color:#c35;'><h2 style='color:white;'>Удалить</h2></div><div class='col-xs-6' id='dsms"+parsed.results[yy].id+"'><h2>Отмена</h2></div></div><script>$('#remconf"+parsed.results[yy].id+"').click(function(){$('#confblock"+parsed.results[yy].id+"').slideToggle();});$('#rem"+parsed.results[yy].id+"').click(function(){removealbum("+parsed.results[yy].id+");});$('#dsms"+parsed.results[yy].id+"').click(function(){$('#confblock"+parsed.results[yy].id+"').slideToggle();});<\/script>");
            }
            }
            }
            };
            request.open('POST', '/misc', true);
            request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            //Most libraries like jQuery/Prototype/Dojo do this
            request.send("cause=albums");          }
            function removealbum(id){
            console.log('going to remove an album');
            request = new XMLHttpRequest();
            request.onreadystatechange = function () {
            var DONE = this.DONE || 4;
            if (this.readyState === DONE){
            var index;
            parsed = JSON.parse(request.responseText);
            console.log(parsed);
            if(parsed.trouble === 1)
            {
            console.log('TROUBLE === 1');
            switch (parsed.mtext){
            case('empty'):
            alert('Заданый альбом не найден в базе');
            break;
            case('db'):
            alert('проблемы с базой данных');
            $('#remconf'+id).slideToggle();
            if($('#confblock'+id).css('display')!=='none'){
            $('#confblock'+id).slideToggle();
            }
            break;
            }}
            else {
            //trouble === 0
            $('#remconf'+id).slideToggle();
            if($('#confblock'+id).css('display')!=='none'){
            $('#confblock'+id).slideToggle();
            alert('Альбом удален')
            }
            }
            }
            };
            request.open('POST', '/actions', true);
            request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            //Most libraries like jQuery/Prototype/Dojo do this
            request.send("actions=removealbum&albumid="+id);}
            $('#albums').click(function(){
            $('#albumsblock').slideToggle();
            });  
            $('#albumsremove').click(function(){
            getalbums();
            $('#albumsremoveblock').slideToggle();
            });           

      
        
