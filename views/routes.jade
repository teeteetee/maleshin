doctype html(lang='en')
head
    meta(charset='utf-8')
    |     
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    |     
    meta(name='viewport', content='width=device-width, initial-scale=1')
    |     
    title MALESHIN
    // Bootstrap
    link(href='bootstrap/css/bootstrap.min.css', rel='stylesheet')
    // jQuery (necessary for Bootstrap's JavaScript plugins)
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js')
    // Include all compiled plugins (below), or include individual files as needed
    script(src='js/bootstrap.min.js')
    // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
    // WARNING: Respond.js doesn't work if you view the page via file://
    //if lt IE 9
      script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
      |       
      script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')
    |     
    style.
      html {
      background-size: cover;
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      min-width:768px;
      }
      @font-face {
      font-family:br;
      src:url('/bootstrap/fonts/bebasneue_regular.ttf');
      }
      @font-face {
      font-family:attentica;
      src:url('/bootstrap/fonts/Attentica.ttf');
      }
      @font-face {
      font-family:roboto-thin;
      src:url('/bootstrap/fonts/Roboto-Thin.ttf');
      }
      body {
      background-color:transparent;
      }
      h1 {
      font-family:attentica;
      font-size:20vw;
      color:white;
      margin:0px;
      }
      h2 {
      color:black;
      font-family:roboto-thin;
      font-size:2vw;
      margin-top:1vh;
      margin-bottom:1vh;
      margin-right:1vw;
      margin-left:1vw;
      }
      h3 {
      font-family:arial;
      font-size:2vw;
      }
      h4 {
      font-weight:bold;
      font-family:br;
      font-size:4vw;
      }
      h5 {
      font-family:roboto-thin;
      color:#c35;
      font-size:2vw;
      font-weight:bold;
      }
      h6 {
      font-family:roboto-thin;
      font-size:8vw;
      color:#03406a;
      opacity:0.5;
      }
      .container {
      margin:0px;
      padding:0px;
      width:100%;
      }
      .btn-default {
      background-color:transparent;
      }
      .btn:hover {
      background-color:white;
      opacity:0.5;
      }
      .btn-default:focus {
      background-color:#e6e6e6;
      }
      .btn-default:focus h2 {
      color:black;
      }
      .btn:hover h2 {
      color:black;
      }
      .btn-group {
      }
      #menu {
      text-align:center;
      margin-top:5vh;
      }
      #header {
      -webkit-transition:height 1.5s;
      -webkit-transition-timing-function:ease-out;
      }
      .active h2 {
      color:black;
      }
      .fff {
      background-color:#fff;
      }
      .text {
      padding-top:3vh;
      padding-bottom:5vh;
      padding-left:10vw;
      padding-right:10vw;
      background-color:#fff;
      } 
      img{
      height:3vw;
      margin:2vh;
      }
  body
    .container
      #header.row
        .col-xs-12
          #menu.row
            .col-xs-12(style='padding:0px;')
              .btn-group
                button#countries.btn.btn-default(type='button', style='border-top-left-radius:0.5vw;border-bottom-left-radius:0.5vw;')
                  h2 &Scy;&Tcy;&Rcy;&Acy;&Ncy;&Ycy;
                button#routes.btn.btn-default.active(type='button')
                  h2 &Mcy;&Acy;&Rcy;&SHcy;&Rcy;&Ucy;&Tcy;&Ycy;
                button#gall.btn.btn-default(type='button')
                  h2 &Gcy;&Acy;&Lcy;&IEcy;&Rcy;&IEcy;&YAcy;
                button#blog.btn.btn-default(type='button')
                  h2 &Bcy;&Lcy;&Ocy;&Gcy;
                button#books.btn.btn-default(type='button')
                  h2 &Kcy;&Ncy;&Icy;&Gcy;&Icy;
                button#about.btn.btn-default(type='button')
                  h2 &Ocy; &Pcy;&Rcy;&Ocy;&IEcy;&Kcy;&Tcy;&IEcy;
                button#contacts.btn.btn-default(type='button', style='border-top-right-radius:0.5vw;border-bottom-right-radius:0.5vw;')
                  h2 &Kcy;&Ocy;&Ncy;&Tcy;&Acy;&Kcy;&Tcy;&Ycy;
      #main.row.text
        .col-xs-12
          each country,i in countries
            .row(style='border-bottom:1px solid #f7f7f7;',id='#{country.routecountry}',onclick='getroutes("#{country.routecountry}");')
              .col-xs-10
                h2 #{country.routecountry}   
              .col-xs-2
                h2 #{country.routesnum}
            .row(style='background-color:#eee;display:none;padding:3vh;',id='#{country.routecountry}routes')  
              .col-xs-12(id='#{country.routecountry}insert')

     
             
          script.
            $('#blog').click(function(){
              window.location='http://maleshin.com/';
            }); 
            $('#countries').click(function(){
              window.location='http://maleshin.com/countries';
            }); 
            $('#books').click(function(){
              window.location='http://maleshin.com/books';
            }); 
            $('#gall').click(function(){
              window.location='http://maleshin.com/gall';
            }); 
            $('#contacts').click(function(){
              window.location='http://maleshin.com/contacts';
            }); 
            $('#about').click(function(){
              window.location='http://maleshin.com/about';
            }); 
            function getroutes(country) {
              $('#updaterouteblockinserts').empty();
              console.log('requesting routes');
              request = new XMLHttpRequest();
              request.onreadystatechange = function () {
              var DONE = this.DONE || 4;
              if (this.readyState === DONE){
              var index;
              parsed = JSON.parse(request.responseText);
              console.log(parsed);
              if(parsed.trouble === 1)
              {
              console.log('TROUBLE === 1');
              switch (parsed.mtext){
              case('db'):
              alert('Проблемы с базой данных');
              break;
              case('empty'):
              alert('Нет маршрутов');
              return;
              break;
              }}
              else {
              //trouble === 0
              var insert ="<div class='row'><div class='col-xs-10 col-xs-offset-1'><h2>Маршруты:</h2></div><div class='col-xs-1 closedialog' id='close"+country+"'><img src='/bootstrap/images/cross_white.png'></div></div><script>$('#close"+country+"').click(function(){$('#"+country+"routes').slideToggle();});<\/script>";
              eval("$('#"+country+"insert').append(insert);");
              for (var yy =0;yy<parsed.mbody.length;yy++){
              var redir = 'http://maleshin.com/route/';
              insert ="<div class='row route' onclick='"+redir+parsed.mbody[yy].id+"' id='route"+parsed.mbody[yy].id+"'><div class='col-xs-12' style='padding-left:0px;'><h2>"+parsed.mbody[yy].routename+"</h2></div></div>"
              console.log(insert);
              console.log("$('"+country+"insert').append(insert);");
              }
              eval("$('#"+country+"routes').slideToggle();");
              }
              }
              };
              request.open('POST', '/actions', true);
              request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made fpurposes.
              request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
              //Most libraries like jQuery/Prototype/Dojo do this
              request.send("actions=countryroutes&country="+country);
            }     
    
